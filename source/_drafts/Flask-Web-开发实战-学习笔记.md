---
title: Flask Web 开发实战|学习笔记
tags:
    - flask
    - web开发
---

## 第一章 初认Flask

### 搭建开发环境

1. Pipenv工作流， 这个就是Python的包管理工具，我们用得太多了
2. 创建虚拟环境，这个我也不多讲了，这是一种Python项目的素养
3. 虽然说这本书中提到了 Pipfile 这种方法来管理依赖，但我还是用回 requestments.txt 加 pip 的方法吧
4. 安装 Flask， 这算是必须的，毕竟这是 Flask 的学习
5. 集成开发环境，我们就用 Pycharm 的社区版吧

### Hello,Flask

在这里，我们写一个最小的 Hello Flask 的程序

### 启动开发服务器

旧的启动方法是使用 app.run()方法，目前已不推荐使用（deprecated）

调试模式开启之后，会自动激活 Werkzeun 内置的调试器(用于调试)，重载器(用于监控代码是否发生改变，然后重新运行项目)

### Python Shell

略

### Flask 扩展

天知道他之后会怎么讲，尽量在效率和灵活性之间达到平衡

### 项目配置

### URL 与端点

使用 Flask 提供的 url_for() 函数获取 URL ，会比硬编码的方式好很多

### Flask 命令

用的可能会比较少，毕竟是在命令行中操作

### 模板与静态文件

模板即 HTML 文件， 静态文件指 CSS 与 JS 与 IMG 等。第三章重点讲

### Flask 与 MVC 架构

## 第二章 Flask 与 HTTP

### 请求响应循环

就是客户端发出请求，服务端处理请求并返回响应

### HTTP 请求

报文的结构基本上就是：报文首部（请求行和首部字段），空行，报文主体

常见的 HTTP 方法

1. GET 方法：获取资源
2. POST 方法：创建或更新资源
3. PUT 方法：创建或替换资源

Request对象就是用户获取请求报文中的所有数据的

url变量转换器，可以将url的值变成各种指定类型。

请求钩子: 在请求的不同过程中会触发到的

### HTTP 响应

1. 常用的HTTP状态码需要记一下

2. 返回的时候可以指定状态码以及重定向url

3. 有各种各样不同的返回类型：纯文本， HTML， XML， JSON

4. 如何设置 Cookie 这个一定要会， 但是这样很危险， 一定不要将用户信息明文保存在 Cookie 中。

5. 例如重定向回上一个页面的功能

6. 确保URL的安全性是很重要的，不然你的网站可能会被重定向到其他的一些钓鱼网站

### Flask 上下文

1. 上下文全局变量
2. 激活上下文
3. 上下文钩子

### HTTP 进阶实践

1. 重定向回上一个页面
2. 使用AJAX技术发送异步请求
3. HTTP 服务器推送
4. Web 安全防范

### Web安全规范

1. 注入攻击:主要是各种命令的注入。如在编写SQL语句时，如果直接将用户传入的数据作为参数使用字符串拼接的方式插入到SQL查询中，那么攻击者可以通过注入其他语言来执行攻击操作，这些攻击操作包括可以通过SQL语句做的任何事情：获取敏感数据、修改数据、删除数据库表
2. XSS攻击:防止用户的输入变成可以执行的代码
3. CSRF攻击: 就是跨站请求伪造

## 第三章 模板

### 模板的基本用法

主要是变量赋值，以及循环之类的内容

### 模板辅助工具

这些工具可以让你更方便地控制模板的输出，我大概了解即可

上下文，全局对象，过滤器，测试器，模板环境对象这些我都不知道是什么？？？

### 模板结构组织

这个是挺重要的，这个技术主要是用来对模板的复用，我们由此可以更好地实践DRY原则

1. 为了和普通模板区分开，局部模板的命名通常以一个下划线开始。
2. 模板竟然也可以继承，这知识点也有点太偏了吧。不过我一看竟然我早就用过了，就是有一个base.html然后其他的来继承它，然后再...地调用它。。

### 模板进阶实验

1. 空白控制可以使多余的空行删除
2. 加载静态文件可以用url_for的方法

## 第四章 表单

变但是我们最常用的用户交互方式之一

### HTML表单

### 使用FLASK-WTF处理表单

message是错误消息

validators接收一个传入可调用对象组成的列表。

WTForms 可以实例化表单类，然后将实例属性转换成字符串或直接是HTML代码，并可以设置HTML属性

### 处理表单数据

就是要验证用户的信息以及转码之类的

1. 提交表单，用get方法会将表单信息暴露在url中，这样很危险。Flask为路由设置默认监听的HTTP方法为GET， 为了支持接收表单提交发送的POST请求，我们必须在app.route()装饰器中使用methods关键字指定HTTP方法
2. 验证表单数据
3. 在模板中渲染错误信息

### 表单进阶实践

1. 设置错误消息语言
2. 使用宏渲染表单
3. 自定义检验器
4. 文件上传，这个要尝试一下
5. 使用Flask-CKEditor集成富文本编辑器
6. 单个表单，多个提交按钮

## 第五章 数据库

> 像是第五章这种的，我就稍微看一下算了

### 数据库分类

说道数据库分类，那当然是分为NoSQL以及SQL，而这一章主要讲的是SQL的

### ORM魔法

常见的开发模式是在开发时使用简单的SQLite，而在部署时切换到MySQL

### 使用Flask-SQLAlchemy管理数据库

1. 连接数据库服务器，就跟以前用法差不多
2. 定义数据库模型，其实就是定义表结构吧
3. 数据库操作，也就是增删改查啦
4. 删除的那种操作千万不要用GET请求，这会使程序处于CSRF攻击的风险之中，防范CSRF攻击的基本原则就是正确使用GET和POST方法

### 更新数据库表

1. 重新生成表
2. 使用Flask-Migrate迁移数据库

### 数据库进阶操作

1. 级联操作，就是在操作一个对象的同时，对相关的对象也执行某些操作
2. 事件监听，就是执行某些行为时，会触发的语句

### 定义关系

就是各种外键，一对多，多对一什么的

## 第六章 电子邮箱

### 使用Flask-Mail发送电子邮件

1. 配置Flask-Mail
2. 构建邮件数据
3. 发送邮件

### 使用事务邮件服务SendGrid

1. 注册SendGrid
2. SendGrid SMTP转发
3. SendGrid Wev API

### 电子邮件进阶实践

1. 提供HTML正文
2. 使用Jinja2模板组织邮件正文
3. 异步发送邮件

## 第七章 留言板

### 使用包组织代码

在这里，可以了解到一个真正的flask项目的结构究竟是怎么安排的

### Web程序开发流程

这一章我认为是挺重要的，因为这里描述了一个完整的简单的web开发大致流程

1. 分析需求，列出功能清单或写需求说明书
2. 设计程序功能，写功能规格书和技术规格书
3. 进入开发与测试的迭代
4. 调试和性能等专项测试
5. 部署上线（deployment）
6. 运行维护与营销

前端开发的主要流程

1. 根据功能规格书画页面草图（sketching）
2. 根据草图做交互式原型图（prototyping）
3. 根据原型图开发前端页面

后端开发的主要流程

1. 数据库建模
2. 编写表单类
3. 编写视图函数和相关处理函数
4. 在页面中使用Jinja2替换虚拟数据

该项目的主要功能

1. 概述
2. 主页
3. 问候表单
4. 问候消息列表
5. 错误页面

### 使用Bootstrap-Flask简化页面编写

这个呢，我倒觉得不太重要，因为Jinje2之类的模板库其实在后面用的应该会比较少了，因为现在的项目大多数是前后分离的项目

### 使用Flask-Moment本地化日期和时间

以后用到再来找它吧

### 使用 Faker 生成虚拟数据

挺好用的，挺爽的

### 使用Flask-DebugToolbar调试程序

### Flask 配置的两种组织形式

这个太重要了，部署的时候一定会用到

## 个人博客

### 大型项目结构

## 第十章 待办事项程序

> 我还是试着直接跳到第十章,但我试着跳过去看之后，我就发现其实不行的，这本书一定要按顺序来看

